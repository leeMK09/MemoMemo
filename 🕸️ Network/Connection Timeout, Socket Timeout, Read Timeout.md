## Connection Timeout

- 클라이언트가 서버에 연결을 시도할 때, 일정 시간 내에 연결이 이루어지지 않으면 발생하는 타임아웃
- TCP 소켓 통신에서 클라이언트와 서버가 연결될 때, 정확한 전송을 보장하기 위해 사전에 세션을 수립
  - 3-way-handshake
- Connection Timeout 은 3-way-handshake 가 일정 시간 내에 완료되지 않을 때 발생합니다.
- 즉, 서버의 장애나 응답 지연으로 인해 연결을 맺지 못하면 Connection Timeout 이 발생합니다
- 외부 API 의 재시도 처리시 해당 Timeout 에러 발생에 재시도를 처리하는 것을 권장한다

</br>
</br>

## Socket Timeout

- Connection Timeout 이후에 발생할 수 있는 타임아웃
- 클라이언트와 서버가 연결된 후, 서버는 데이터를 클라이언트에게 전송합니다.
- 이때 하나의 데이터 덩어리가 아니라 여러 개의 패킷 단위로 쪼개서 전송되는데, 각 패킷이 전송될 때의 시간 차이 제한을 Socket Timeout 이라고 합니다
- 만약 서버가 일정 시간 내에 다음 패킷을 보내지 않으면, 클라이언트는 Socket Timeout 을 발생시키고 연결을 종료할 수 있습니다.
- Apache HttpClient 는 Socket Timeout 을 설정할 수 있습니다.
- Socket Timeout 은 네트워크 패킷 단위를 기준으로 하기 때문에 전체 응답 시간에 대한 타임아웃을 의미하지 않습니다

</br>
</br>

## Read Timeout

- 클라이언트와 서버가 연결된 후, 특정 I/O 작업이 일정 시간 내에 완료되지 않으면 발생하는 타임아웃 입니다.
- 클라이언트와 서버가 연결된 상태에서 서버의 응답이 지연되거나 I/O 작업이 길어져 요청이 처리되지 않을 때 클라이언트는 연결을 끊습니다.
- Read Timeout 은 이러한 상황을 방지하기 위해 설정된 타임아웃으로 일정 시간 내에 데이터가 읽혀지지 않으면 클라이언트가 연결을 종료합니다.
- Read Timeout 은 재시도할 때 주의해야 합니다.
- 이 경우 이미 해당 API 호출 서비스는 요청을 처리하는 중이기 때문에 Read Timeout 이 발생한 상황에서 재시도를 하면 중복 처리되는 데이터 일관성의 문제가 발생할 수 있습니다.

</br>

> 호출 타임아웃 (call timeout)
>
> OkHttp 는 Read Timeout 과는 별개로 호출 타임아웃 (call timeout) 을 설정할 수 있습니다.
> 호출 타임아웃은 요청 시작부터 응답까지의 전체 시간 기준으로 설정됩니다.
>
> Socket Timeout 을 5초로, Call Timeout 을 10초로 설정하면 패킷은 계속 수신되지만 전체 처리 시간이 오래 걸리는 경우에 타임아웃이 발생할 수 있습니다.
