## 왜 상태가 필요한가?

객체가 주변 환경과의 상호작용에 어떻게 반응하는가는 그 시점까지 객체에 어떤 일이 발생했느냐에 좌우된다

- 여행을 위해 비행기를 이용하려면 탑승 전에 항공권을 발권해야 한다
  - 비행기 탑승 여부는 과거에 항공권을 발권하는 행동이 발생했는지 여부에 따라 달라지는 것 이다
- 텔레비전 전원을 켜지 않는 한 채널을 변경할 수 없다
- 친구와 드라이브를 하려면 먼저 자동차의 시동을 걸어야 한다

예로 든 모든 일들의 공통점은 어떤 행동의 결과는 → 과거에 어떤 행동들이 일어났었느냐에 의존한다는 것 이다

**즉 행동의 결과는 과거의 상태에 의존한다**

</br>

이를 위해 과거에 했던 모든 행동을 기억하는 방법이 존재한다

그러나 이는 행동의 결과를 설명하는 것을 매우 어렵게 만든다

일반적으로 과거에 발생한 행동의 이력을 통해 현재 발생한 행동의 결과를 판단하는 방식은 복잡하고 번거로우며 이해하기 어렵다

따라서 인간은 행동의 과정과 결과를 단순하게 기술하기 위해 "상태" 라는 개념을 고안했다

비행기 탑승 가능 여부는 항공권의 발권 상태를 보고 예측할 수 있다

텔레비전 전원이 들어온 상태여야만 채널을 변경할 수 있다

친구와 함께 즐거운 드라이브를 즐기려면 자동차의 시동이 걸려 있는 상태여야만 한다

**"상태"를 이용하면 과거의 모든 행동 이력을 설명하지 않고도 행동의 결과를 쉽게 예측하고 설명할 수 있다**

</br>
</br>

## 때로는 단순한 값이 아니라 객체를 사용해 다른 객체의 상태를 표현해야할 때가 있다

예를들어 사람이 현재 음료를 들고 있는 상태인지를 표현하고 싶다면 어떻게 할 것 인가?

가장 간단하고 직관적인 방법은 사람의 상태 일부를 음료라는 객체를 이용해 표현하는 것 이다

사람이 음료를 들고 있는지 여부는 사람이라는 객체가 음료라는 객체와 연결되어 있는지 여부로 표현할 수 있다

즉, 객체지향 관점에서 사람은 음료에 관해 알고 있는 상태이며 사람 객체와 음료 객체는 서로 연결되어 있다

결론적으로 모든 객체의 상태는 단순한 값과 객체의 조합으로 표현할 수 있다

이때 객체의 상태를 구성하는 모든 특징을 통틀어 객체의 프로퍼티(property) 라고 한다

사람의 경우 이름/키/주민번호 그리고 음료 가 사람의 프로퍼티가 된다

일반적으로 프로퍼티는 변경되지 않고 고정되기 때문에 "정적"이다

반면 프로퍼티의 값(property value) 은 시간이 흐름에 따라 변경되기 때문에 "동적" 이다

음료를 다 마신 후라면 음료를 버리게 될 것 이다

객체지향의 세계에서 객체는 다른 객체의 상태에 직접적으로 접근할 수도, 상태를 변경할 수도 없다

자율적인 객체는 스스로 자신의 상태를 책임져야 한다

행동은 다른 객체로 하여금 간접적으로 객체의 상태를 변경하는 것을 가능하게 한다

</br>
</br>

## 상태와 행동

객체의 상태는 저절로 변경되지 않는다

객체의 상태를 변경하는 것은 객체의 자발적인 행동뿐이다

사람이 음료를 마시는 행동

객체가 취하는 행동은 객체 자신의 상태를 변경시킨다

객체의 행동에 의해 객체의 상태가 변경된다는 것은 행동이 부수 효과(side effect) 를 초래한다는 것을 의미한다

앞서 설명한 것처럼 객체의 행동은 객체의 상태를 변경시키지만 "행동의 결과는 객체의 상태에 의존적이다"

음료를 마신 후 사람은 음료를 마시기 전의 사람보다 목마르지 않는다

이것은 음료를 마시는 행동의 결과가 사람의 목마름에 의존한다 는 것을 의미한다

따라서 상태와 행동 사이에는 다음과 같은 관계가 있음을 알 수 있다

- 객체의 행동은 상태에 영향을 받는다
- 객체의 행동은 상태를 변경시킨다

</br>
</br>

## 협력과 행동

어떤 객체도 섬이 아니다

객체는 자신에게 주어진 책임을 완수하기 위해 다른 객체를 이용하고 다른 객체에게 서비스를 제공한다

객체는 협력에 참여하는 과정에서 자기 자신의 상태뿐만 아니라 다른 객체의 상태 변경을 유발할 수 있다

음료를 마시면 사람은 목마르지 않는 동시에 먹은 양만큼 음료의 양이 줄어야 한다

따라서 음료를 마시는 행동은 자기자신(사람) 뿐만 아니라 음료의 상태 변경도 유발한다

</br>
</br>

## 상태 캡슐화

현실 세계의 객체와 객체지향 세계의 객체 사이에는 중요한 차이점이 있다

현실 속에서 사람은 스스로 음료를 마시는 능동적인 존재지만 음료는 스스로 아무것도 할 수 없는 수동적인 존재이다

현실 세계라면 음료의 양을 줄여, 상태를 변경시키는 주체는 음료를 마시는 사람이 될 것 이다

그러나 객체지향의 세계에서 모든 객체는 자신의 상태를 스스로 관리하는 자율적인 존재이다

즉 음료 객체의 양을 줄이는 것은 음료 자신이어야 한다

따라서 사람이 직접적으로 음료를 변경할 수 없다

단지 음료에게 자신이 음료를 마셨다는 메시지를 전달할 수 있을 뿐이다

음료의 양이 줄어들 것인지는 메시지를 수신한 음료가 결정할 사항이며 사람과는 무관하다

단지 사람은 음료의 양이 줄어들 것이라는 것을 믿고 요청을 전달할 뿐이다

메시지를 사람에게 전송하는 객체이건 음료에게 메시지를 전송하는 사람 객체이건 메시지 송신자(메시지를 보내는 객체) 는 메시지 수신자(메시지를 받는 객체) 의 상태 변경에 대해서는 전혀 알지 못한다

이것이 캡슐화가 의미하는 것 이다

객체는 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않는다

객체가 외부에 노출하는 것은 행동뿐이며 외부에서 객체에 접근할 수 있는 유일한 방법 역시 행동뿐이다

</br>
</br>

## 식별자

모든 객체가 식별자를 가진다는 것은 반대로 객체가 아닌 단순한 값은 식별자를 가지지 않는다는 것을 의미한다

값과 객체의 가장 큰 차이점은 값은 식별자를 가지지 않지만 객체는 식별자를 가진다는 점이다

그리고 시스템을 설계할 때는 이런 단순한 값과 객체의 차이점을 명확하게 구분하고 명시적으로 표현하는 것이 매우 중요하다

값(value) 은 숫자, 문자열, 날짜, 시간, 금액 등과 같이 변하지 않는 양을 모델링한다

흔히 값의 상태는 변하지 않기 때문에 불변 상태(immutable state) 를 가진다고 말한다

두 개의 1 이라는 숫자가 종이 위에 적혀 있을 때 모든 사람들은 두 숫자가 같은 것으로 간주한다

두 숫자는 값이 같기 때문에 동일하다고 판단하며 굳이 두 개의 숫자를 구별하려고 하지 않는다

**값은 오직 상태만을 이용해 동등성을 판단하기 때문에 인스턴스를 구별하기 위한 별도의 식별자를 필요로 하지 않는다**

객체는 시간에 따라 변경되는 상태를 포함하며 행동을 통해 상태를 변경한다

따라서 객체는 가변 상태(mutable state) 를 가진다고 말한다

타입이 같은 두 객체의 상태가 완전히 똑같더라도 두 객체는 독립적인 별개의 객체로 다뤄야 한다

이름이 같은 사람이 있더라도 어떤 누구도 두 사람을 같은 사람이라고 생각하지 않는다

어린시절을 떠올려보면 키가 작은 나도 자신이고 나이가 들고 키가 커진 나도 자신이다

즉, 상태와 무관하게 동일한 사람으로 판단될 수 있는 일종의 식별자를 가지고 있는 객체라고 할 수 있다
