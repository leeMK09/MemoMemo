## 동기방식의 외부 연동

- 동기방식이 외부 연동을 만나면 고려해야 할 점이 있다
- 먼저 외부 연동 실패가 전체 기능의 실패인지 확인해야 한다
- 만약 포인트 지급 서비스 연동에 실패하면 로그인에도 실패한다고 가정했을때, 만약 포인트 지급 서비스에 장애가 발생한다면 그 시간 동안 로그인도 못해서 전체 기능을 사용할 수 없게 된다
  - 이게 맞는걸까? → 아마도 그렇지 않을 것 이다
- 이를 위해 포인트 지급에 실패하면 나중에 후처리할 수 있도록 지급 실패 내역을 따로 남기는 방식으로 코드를 작성할 수 있다
- 연동하는 외부 서비스의 응답 시간도 고려해야 한다. 연동 서비스의 응답 시간이 길어질수록 전체 응답 시간이 느려지게 된다
- 다음 작업을 진행하기 위해 반드시 외부 연동 결과가 필요한게 아니라면, 동기 방식 대신 비동기 방식으로 연동하는 것을 고민해 볼 필요가 있다
  - 즉, 외부 연동이 끝날때까지 기다리지 않고 바로 다음 작업을 진행하는 방식

</br>
</br>

## 생각보다 많은 연동에서 비동기 방식을 사용한다

- 다음은 비동기 방식으로 연동해도 크게 문제가 되지 않는 몇가지 사례이다
  - 쇼핑몰에서 주문이 들어오면 판매자에게 푸시 보내기 (푸시 서비스 연동)
  - 학습을 완료하면 학생에게 포인트 지급 (포인트 서비스 연동)
  - 컨텐츠를 등록할 때 검색 서비스에도 등록 (검색 서비스 연동)
  - 인증 번호를 요청하면 SMS 로 인증 메시지 발송 (SMS 발송 서비스 연동)
- 위 사례들은 몇가지 공통적인 특징이 있다

</br>

### 1. 연동에 약간의 시차가 생겨도 문제가 되지 않는다

- 쇼핑몰에서 주문이 완료된 후 1분 뒤에 판매자에게 푸시가 되고 판매에는 지장이 없다

</br>

### 2. 일부 기능은 싪패했을 때 재시도가 가능하다

- 푸시 발송에 실패했을 경우 재시도를 통해 푸시가 발송될 수 있다
- 학습 완료 후 포인트 지급에 실패했을 때, 몇 초 뒤에 다시 시도하여 포인트 지급에 성공하면 문제가 되지 않는다

</br>

### 3. 연동에 실패했을 때 나중에 수동으로 처리할 수 있는 기등도 있다

- 검색 서비스 연동에 실패해 컨텐츠가 검색에 노출되지 않는 경우, 컨텐츠 작성자가 검색에 노출되지 않는다고 문의할 때 관리 툴을 사용하여 수동으로 컨텐츠를 검색 서비스에 연동할 수 있다

</br>

### 4. 연동에 실패했을 때 무시해도 되는 기능도 있다

- 주문이 들어왔을 때 판매자에게 푸시가 발송되지 않더라도 판매에는 문제가 생기지 않는다 단지, 주문 확인이 늦어질 뿐 이다

외부 연동이 4가지 특징 중 일부에 해당하면 비동기로 처리할 수 있는지 검토하는 것이 좋다
